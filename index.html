<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Chessjs</title>
</head>
<body>
    <canvas id="canva" width="400" height="400"></canvas>

    <script src="./index.js"></script>
    <script>
        const Canva = document.getElementById('canva');
        const ctx = canva.getContext('2d');
        const tablero = new Tablero();

        const images = [
            'assets/white/Pawn.png',
            'assets/white/Rook.png',
            'assets/white/Knight.png',
            'assets/white/Bishop.png',
            'assets/white/Queen.png',
            'assets/white/King.png',
            'assets/black/Pawn.png',
            'assets/black/Rook.png',
            'assets/black/Knight.png',
            'assets/black/Bishop.png',
            'assets/black/Queen.png',
            'assets/black/King.png'
        ]
        Promise.all(images.map((url) => loadImage(url)))
            .then((sprites) => {
                drawChessBoard(sprites);
            });

        function loadImage (url) {
            return new Promise((resolve, reject) => {
                const img = new Image();
                img.addEventListener('load', () => resolve(img));
                img.addEventListener('error', err => reject(err));
                img.src = url;
            });
        } 
        function drawChessBoard (sprites) {
            let x = 0;
            let y = 0;
            let color = 'black';

            for (let i = 0; i < 8; i++) {
                if (i % 2 == 0) color = 'white';
                else color = 'black';
                for (let j = 0; j < 8; j++) {
                    if (color === 'black') {
                        ctx.fillStyle = '#779954';
                        ctx.fillRect(x, y, 50, 50);
                        color = 'white';
                    } else {
                        ctx.fillStyle = '#e9edcc';
                        ctx.fillRect(x, y, 50, 50);
                        color = 'black';
                    }

                    if (tablero.render()[i][j] != ' ') {
                        switch (tablero.render()[i][j]) {
                            case 'p': ctx.drawImage(sprites[0], x, y, 50, 50); break;
                            case 'r': ctx.drawImage(sprites[1], x, y, 50, 50); break;
                            case 'n': ctx.drawImage(sprites[2], x, y, 50, 50); break;
                            case 'b': ctx.drawImage(sprites[3], x, y, 50, 50); break;
                            case 'q': ctx.drawImage(sprites[4], x, y, 50, 50); break;
                            case 'k': ctx.drawImage(sprites[5], x, y, 50, 50); break;
                            case 'P': ctx.drawImage(sprites[6], x, y, 50, 50); break;
                            case 'R': ctx.drawImage(sprites[7], x, y, 50, 50); break;
                            case 'N': ctx.drawImage(sprites[8], x, y, 50, 50); break;
                            case 'B': ctx.drawImage(sprites[9], x, y, 50, 50); break;
                            case 'Q': ctx.drawImage(sprites[10], x, y, 50, 50); break;
                            case 'K': ctx.drawImage(sprites[11], x, y, 50, 50); break;
                        }
                    }
                    x += 50;
                }

                x = 0;
                y += 50;
            }
        }
    </script>
</body>
</html>